function sendToServer(){""!=document.getElementById("rs_url").value&&window.open(document.getElementById("rs_url").value,"_blank")}function setLabels(c,a){document.getElementById("help_label").innerHTML=c;document.getElementById("help_label").href=a}
function changeItem(){var c=document.getElementById("lst_nom").value;document.getElementById("datatype").value=c;document.getElementById("rs_url").value="";document.getElementById("rs_server").value="";document.getElementById("insert_field").checked=!0;document.getElementById("insert_field").disabled=!1;document.getElementById("no_deffield").checked=!1;document.getElementById("no_deffield").disabled=!1;url=window.location.protocol+"//"+window.location.host+"/nerva2py/wizard/get_nom_data?nom=@nom&database=@database&username=@username&password=@password";
url=url.replace("@nom",c);url=url.replace("@database",document.getElementById("database").value);url=url.replace("@username",document.getElementById("username").value);url=url.replace("@password",document.getElementById("password").value);switch(c){case "sql":document.getElementById("rs_sql").style.display="block";document.getElementById("rs_nosql").style.display="none";$("#tabs").tabs({active:0});$("#tabs").tabs({disabled:[1,2]});break;default:document.getElementById("rs_sql").style.display="none";
document.getElementById("rs_nosql").style.display="block";$("#tabs").tabs({disabled:!1});switch(c){case "groups":case "fieldvalue":case "numberdef":case "deffield":case "pattern":document.getElementById("insert_field").checked=!1,document.getElementById("insert_field").disabled=!0,document.getElementById("no_deffield").checked=!1,document.getElementById("no_deffield").disabled=!0}jQuery.ajax({type:"POST",url:url,success:function(a){document.getElementById("rs_view").innerHTML=a.split("||")[0];document.getElementById("rs_update").innerHTML=
a.split("||")[1];document.getElementById("rs_delete").innerHTML=a.split("||")[2]}})}}function getUrl(c){var a;a="@protocol//@server/@function?@code&@params&@data".replace("@protocol",window.location.protocol);a=a.replace("@server",window.location.host);a=a.replace("@function","nerva2py/ndi/"+c);return a=a.replace("@code","code="+document.getElementById("code").value)}
function getParams(c){var a;a="database=@database|username=@username|password=@password|datatype=@datatype".replace("@database",document.getElementById("database").value);a=a.replace("@username",document.getElementById("username").value);a=a.replace("@password",document.getElementById("password").value);a=a.replace("@datatype",document.getElementById("datatype").value);document.getElementById("use_deleted").checked&&(a+="|use_deleted");"updateData"==c&&document.getElementById("insert_row").checked&&
(a+="|insert_row");"updateData"==c&&document.getElementById("insert_field").checked&&(a+="|insert_field");return a="base64"==document.getElementById("code").value||"base64all"==document.getElementById("code").value?"params="+$.base64.encode(a):"params="+a}
function getParamsPy(c){var a='"datatype":"'+document.getElementById("datatype").value+'"';"updateData"==c&&document.getElementById("insert_row").checked&&(a+=',"insert_row":True');"updateData"==c&&document.getElementById("insert_field").checked&&(a+=',"insert_field":True');return a}
function createView(){if(""!=document.getElementById("datatype").value){var c=getUrl("getData"),a=getParams("getData"),g=getParamsPy("getData"),b="",e="";if("sql"!=document.getElementById("datatype").value){for(var b=b+("output="+document.getElementById("output").value),e=e+('"output":"'+document.getElementById("output").value+'"'),f=$("#rs_view :input"),d=0;d<f.length;d++)""!=f[d].value&&("log"==document.getElementById("datatype").value&&"notype"==f[d].value?(b+="|"+f[d].value,e+=',"notype":True'):
(b+="|"+f[d].name+"="+f[d].value,e+=',"'+f[d].name+'":"'+f[d].value+'"'));f=["where","orderby","header","columns"];for(d=0;d<f.length;d++)""!=document.getElementById(f[d]).value&&(b+="|"+f[d]+"="+document.getElementById(f[d]).value,e+=',"'+f[d]+'":"'+document.getElementById(f[d]).value+'"');document.getElementById("show_id").checked&&(b+="|show_id",e+=',"show_id":True');document.getElementById("no_deffield").checked&&(b+="|no_deffield",e+=',"no_deffield":True')}else b+="output="+document.getElementById("output_sql").value,
e+='"output":"'+document.getElementById("output_sql").value+'"',b+="|sql="+document.getElementById("sql").value,e+=',"sql":"'+document.getElementById("sql").value+'"';b="base64"==document.getElementById("code").value||"base64all"==document.getElementById("code").value?"filters="+$.base64.encode(b):"filters="+b;c=c.replace("@params",a);c=c.replace("@data",b);document.getElementById("rs_url").value=c;e="getView({"+g+"},{"+e+"})";document.getElementById("rs_server").value=e}}
function getUpdateInputs(){for(var c=[,[],[],[],[]],a=$("#rs_update :input"),g=0;g<a.length;g++)-1==a[g].id.indexOf("select_")&&document.getElementById("select_"+a[g].name+"_"+a[g].parentElement.id).checked&&c[a[g].parentElement.id].push(a[g]);return c}
function createUpdate(){if(""!=document.getElementById("datatype").value){for(var c=getUrl("updateData"),a=getParams("updateData"),g=getParamsPy("updateData"),b="",e="",f=getUpdateInputs(d),d=1;5>d;d++){for(var k="",l="",h=0;h<f[d].length;h++)k+="|"+f[d][h].name+"="+f[d][h].value,l+=',"'+f[d][h].name+'":"'+f[d][h].value+'"';""!=k&&(b+="|"+k,e+=",{"+l.substring(1)+"}")}b="base64"==document.getElementById("code").value||"base64all"==document.getElementById("code").value?"data="+$.base64.encode(b.substring(2)):
"data="+b.substring(2);c=c.replace("@params",a);c=c.replace("@data",b);document.getElementById("rs_url").value=c;e="update_"+document.getElementById("datatype").value+"({"+g+"},["+e.substring(1)+"])";document.getElementById("rs_server").value=e}}function getDeleteInputs(c){for(var a=[],g=$("#rs_delete :input"),b=0;b<g.length;b++)g[b].parentElement.id==c&&a.push(g[b]);return a}
function createDelete(){if(""!=document.getElementById("datatype").value){for(var c=getUrl("deleteData"),a=getParams("deleteData"),g=getParamsPy("deleteData"),b="",e="",f=1;5>f;f++)if(document.getElementById("row_"+f).checked||1==f){for(var d=getDeleteInputs(f),k="",l="",h=0;h<d.length;h++){if(""==d[h].value){alert(ms_missing);return}k+="|"+d[h].name+"="+d[h].value;l+=',"'+d[h].name+'":"'+d[h].value+'"'}b+="|"+k;e+=",{"+l.substring(1)+"}"}b="base64"==document.getElementById("code").value||"base64all"==
document.getElementById("code").value?"data="+$.base64.encode(b.substring(2)):"data="+b.substring(2);c=c.replace("@params",a);c=c.replace("@data",b);document.getElementById("rs_url").value=c;e="delete_"+document.getElementById("datatype").value+"({"+g+"},["+e.substring(1)+"])";document.getElementById("rs_server").value=e}};