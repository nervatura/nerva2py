var report=function(Y,Z,aa){function P(a){"#"===a.charAt(0)&&(a=a.substring(1,7));return(parseInt(a.substring(0,2),16)+parseInt(a.substring(2,4),16)+parseInt(a.substring(4,6),16))/3}function h(a,b){return"undefined"!==typeof a&&null!==a?a:b}function G(a,b){var d=f.internal.pageSize.height-c.template.margins["bottom-margin"];a<f.internal.pageSize.height-c.template.page.footer_height-c.template.margins["bottom-margin"]&&(d-=c.template.page.footer_height);return a+b>d?!0:!1}function D(a){function b(a){-1<
a.indexOf("{{page}}")&&(a=a.replace("{{page}}",c.template.page.current_page.toString()));var b=a.split(".");if("undefined"!==typeof c.template.elements.data[b[0]])if("object"===typeof c.template.elements.data[b[0]])if(Array.isArray(c.template.elements.data[b[0]]))try{return null!==c.template.elements.data[b[0]][parseInt(b[1])][b[2]]?c.template.elements.data[b[0]][parseInt(b[1])][b[2]].toString():""}catch(d){return a}else try{return null!==c.template.elements.data[b[0]][b[1]]?c.template.elements.data[b[0]][b[1]].toString():
""}catch(f){return a}else return null!==c.template.elements.data[b[0]]?c.template.elements.data[b[0]].toString():"";else return a}if(-1<a.indexOf("={{")&&-1<a.indexOf("}}")){var d=a.substring(a.indexOf("={{")+3,a.indexOf("}}"));a=a.replace("={{"+d+"}}",b(d));return-1<a.indexOf("={{")&&-1<a.indexOf("}}")?D(a):a}return b(a)}function Q(a,b){if(-1<a.indexOf("={{")&&-1<a.indexOf("}}")){var d=a.substring(a.indexOf("={{"),a.indexOf("}}")+2),e=D(d);a=a.replace(d,e);c.template.xml.details+="\n    <"+b.toString()+
"><![CDATA["+e.toString()+"]]\x3e</"+b.toString()+">";if(-1<a.indexOf("={{")&&-1<a.indexOf("}}"))Q(a,b);else return a}else return a}function v(a){return 0<Object.getOwnPropertyNames(a).length?Object.getOwnPropertyNames(a)[0]:null}function J(a,b){if("undefined"===typeof b||null===b)b={};b["font-family"]=h(a["font-family"],null);b["font-style"]=h(a["font-style"],null);b["font-size"]=h(a["font-size"],null);b.color=h(a.color,null);b["border-color"]=h(a["border-color"],null);b["background-color"]=h(a["background-color"],
null);return b}function E(a){f.setFont(c.template.style["font-family"]);"undefined"!==typeof a["font-family"]&&null!==a["font-family"]&&f.setFont(a["font-family"]);f.setFontType(c.template.style["font-style"]);"undefined"!==typeof a["font-style"]&&null!==a["font-style"]&&f.setFontType(a["font-style"]);f.setFontSize(c.template.style["font-size"]);"undefined"!==typeof a["font-size"]&&null!==a["font-size"]&&f.setFontSize(a["font-size"]);if("undefined"===typeof a.color||null===a.color)a.color=c.template.style.color;
f.setTextColor(a.color);if("undefined"===typeof a["background-color"]||null===a["background-color"])a["background-color"]=c.template.style["background-color"];f.setFillColor(a["background-color"]);if("undefined"===typeof a["border-color"]||null===a["border-color"])a["border-color"]=c.template.style["border-color"];f.setDrawColor(a["border-color"])}function R(a,b,c,e){a=isFinite(+a)?+a:0;b=isFinite(+b)?Math.abs(b):0;e="undefined"===typeof e?",":e;c="undefined"===typeof c?".":c;var g=function(a,b){var c=
Math.pow(10,b);return Math.round(a*c)/c};a=(b?g(a,b):Math.round(a)).toString().split(".");3<a[0].length&&(a[0]=a[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,e));(a[1]||"").length<b&&(a[1]=a[1]||"",a[1]+=Array(b-a[1].length+1).join("0"));return a.join(c)}function H(a,b,c,e){f.setFontType(null===e?"normal":e);a=f.splitTextToSize(a,b-2*c);return{text:a,height:f.internal.getLineHeight()/f.internal.scaleFactor*a.length+c}}function S(a){var b={width:0,height:0},c=document.createElement("img");c.id="pimg";c.src=
a;document.body.appendChild(c);b.width=c.width/f.internal.scaleFactor;b.height=c.height/f.internal.scaleFactor;document.body.removeChild(c);return b}function T(){for(var a=c.template.elements.header,b=0;b<a.length;b++){var d=v(a[b]);switch(d){case "row":case "vgap":case "hline":K("header",d,a[b][d])}}}function U(){for(var a=c.template.elements.footer,b=0;b<a.length;b++){var d=v(a[b]);switch(d){case "row":case "vgap":case "hline":K("footer",d,a[b][d])}}}function K(a,b,d){var e={};switch(b){case "row":ba(a,
d);break;case "vgap":d=h(d.height,0);0<d&&(G(c.template.page.cursor.y,d)?f.addPage():c.template.page.cursor.y+=d);break;case "hline":a=parseFloat(h(d.width,0));b=h(d.gap,0);0===a&&(a=f.internal.pageSize.width-c.template.margins["left-margin"]-c.template.margins["right-margin"]);"undefined"!==typeof d["border-color"]&&(e={"border-color":d["border-color"]},E(e));f.line(c.template.page.cursor.x,c.template.page.cursor.y,c.template.page.cursor.x+a,c.template.page.cursor.y);0<b&&f.line(c.template.page.cursor.x,
c.template.page.cursor.y+b,c.template.page.cursor.x+a,c.template.page.cursor.y+b);c.template.page.cursor.x=c.template.margins["left-margin"];c.template.page.cursor.y+=1+b;break;case "html":a=d.html;b=h(d.fieldname,"head");e=J(d);E(e);f.text("",0,0);a=Q(a,b);f.fromHTML(a,c.template.page.cursor.x,c.template.page.cursor.y,{width:f.internal.pageSize.width-c.template.margins["left-margin"]-c.template.margins["right-margin"],elementHandlers:function(){}},function(a){c.template.page.cursor.x=c.template.margins["left-margin"];
c.template.page.cursor.y=a.y;return!0},{top:c.template.margins["top-margin"]+c.template.page.header_height,bottom:c.template.margins["bottom-margin"]+c.template.page.footer_height});break;case "datagrid":ca(d)}return!0}function ca(a){var b=h(a.databind,null);if(null===b)return!0;b=c.template.elements.data[b];if("undefined"===typeof b||0===b.length)return!0;var d=J(a);d.xname=h(a.name,"items");d.border=h(a.border,"1");var e={"font-size":d["font-size"],color:d.color,"border-color":d["border-color"],
border:d.border,merge:0,"font-style":"bold",text:"",height:0,columns:[],columns_width:0,grid_width:h(a.width,"100%")};e.merge=h(a.merge,0);e["background-color"]=h(a["header-background"],null);var g=f.internal.pageSize.width-c.template.margins["right-margin"]-c.template.margins["left-margin"];-1<e.grid_width.indexOf("%")?e.grid_width=g*(parseFloat(e.grid_width.replace("%",""))/100):(e.grid_width=parseFloat(e.grid_width),e.grid_width>g&&(e.grid_width=g));var q={"font-size":d["font-size"],color:d.color,
"border-color":d["border-color"],border:d.border,"font-style":"bold",text:"",height:0};q["background-color"]=h(a["footer-background"],null);e.extend=d.extend=q.extend=e.grid_width===g;var n=[],g=0;if(0<a.columns.length){a=a.columns;for(var k=0;k<a.length;k++){var l=a[k].column;if(e.columns_width>=e.grid_width)return!1;var m={"font-size":d["font-size"],color:d.color,"border-color":d["border-color"],border:d.border};m.fieldname=h(l.fieldname,"");m.label=D(h(l.label,""));if(0===e.merge){m.width=h(l.width,
null);null!==m.width?-1<m.width.toString().indexOf("%")?m.width=e.grid_width*(parseFloat(m.width.replace("%",""))/100):m.width=parseFloat(m.width):m.width=parseFloat(f.getStringUnitWidth(m.label)*f.internal.getFontSize()/f.internal.scaleFactor+2*c.template.page.padding)+1;e.columns_width+m.width>=e.grid_width&&(m.width=e.grid_width-e.columns_width);e.columns_width+=m.width;var p=H(m.label,m.width,c.template.page.padding,e["font-style"]).height;p>e.height&&(e.height=p)}m.header_align=h(l["header-align"],
"left");m.align=h(l.align,"left");m.multiline="left"===m.align?"true":"false";if("undefined"!==typeof l.thousands||"undefined"!==l.digit||"undefined"!==typeof l.decpoint)m.numbercol=!0,m.thousands=h(l.thousands,""),m.digit=h(l.digit,0),m.decpoint=h(l.decpoint,".");var p=D(h(l.footer,"")),r=h(l["footer-align"],"left");m.numbercol&&!isNaN(+p)&&isFinite(p)&&(p=R(p,m.digit,m.decpoint,m.thousands));""!==h(l.footer,"")?(0===n.length?n.push({text:p,align:r,width:g+m.width}):(n[n.length-1].width+=g,n.push({text:p,
align:r,width:m.width})),g=0):g+=m.width;m.ln=a.length-1===k?1:0;e.columns.push(m)}}else return!0;0===e.merge&&V(e);b.forEach(function(a,b){c.template.xml.details+="\n    <"+d.xname.toString()+">";d.height=0;d.text="";e.columns.forEach(function(g){g.text="counter"===g.fieldname?(b+1).toString():"undefined"!==typeof a[g.fieldname]&&null!==a[g.fieldname]?a[g.fieldname]:"";g.numbercol&&!isNaN(+g.text)&&isFinite(g.text)&&""!==g.text&&(g.text=R(g.text,g.digit,g.decpoint,g.thousands));0===e.merge?(g=H(g.text,
g.width,c.template.page.padding,d["font-style"]).height,g>d.height&&(d.height=g)):(d.text+=" "+g.text,c.template.xml.details+="\n      <"+g.fieldname.toString()+"><![CDATA["+g.text.toString()+"]]\x3e</"+g.fieldname.toString()+">")});0===e.merge?e.columns.forEach(function(a){d.text=a.text;d.width=a.width;d.align=a.align;d.ln=a.ln;d.multiline=a.multiline;F(d,e);c.template.xml.details+="\n      <"+a.fieldname.toString()+"><![CDATA["+a.text.toString()+"]]\x3e</"+a.fieldname.toString()+">"}):(d.text=d.text.trim(),
d.width=null,d.ln=1,d.multiline="true",d.height=null,F(d));c.template.xml.details+="\n    </"+d.xname.toString()+">"});0===e.merge&&(n.forEach(function(a){a=H(a.text,a.width,c.template.page.padding,q["font-style"]).height;a>q.height&&(q.height=a)}),n.forEach(function(a,b){q.text=a.text;q.width=a.width;q.align=a.align;q.multiline="left"===q.align?"true":"false";q.ln=n.length-1===b?1:0;F(q,e);c.template.xml.details+="\n    <"+d.xname.toString()+"_footer><![CDATA["+a.text.toString()+"]]\x3e</"+d.xname.toString()+
"_footer>"}))}function V(a){a.height=0;a.x=null;a.y=null;a.columns.forEach(function(b){0===a.merge?(a.text=b.label,a.ln=b.ln,0===b.width&&(b.width=(a.grid_width-a.columns_width)/a.columns.length),a.width=b.width):a.text+=" "+b.label;a.align=b.header_align;a.multiline="left"===a.align?"true":"false";F(a,a);a.width>b.width&&(b.width=a.width)})}function F(a,b){E(a);if("undefined"===typeof a.text||null===a.text)a.text="";a.x="undefined"===typeof a.x||null===a.x?parseFloat(c.template.page.cursor.x):parseFloat(a.x);
a.y="undefined"===typeof a.y||null===a.y?parseFloat(c.template.page.cursor.y):parseFloat(a.y);a.padding="undefined"===typeof a.padding||null===a.padding?parseInt(c.template.page.padding):parseInt(a.padding);if("undefined"===typeof a.multiline||null===a.multiline)a.multiline="false";a.ln="undefined"===typeof a.ln||null===a.ln?0:parseInt(a.ln);0<a.ln&&a.extend?a.width=f.internal.pageSize.width-c.template.margins["right-margin"]-a.x:("undefined"===typeof a.width||null===a.width?a.width=parseFloat(f.getStringUnitWidth(a.text)*
f.internal.getFontSize()/f.internal.scaleFactor+2*a.padding)+1:-1<a.width.toString().indexOf("%")?a.width=(f.internal.pageSize.width-c.template.margins["right-margin"]-c.template.margins["left-margin"])*(parseFloat(a.width.toString().replace("%",""))/100):a.width=parseFloat(a.width),a.x+a.padding+a.width>f.internal.pageSize.width-c.template.margins["right-margin"]&&(a.width=f.internal.pageSize.width-c.template.margins["right-margin"]-a.x));0>a.width&&(a.width=0,a.text="");var d=parseFloat(f.internal.getLineHeight()/
f.internal.scaleFactor)+a.padding;"undefined"===typeof a.height||null===a.height?a.height=d:d>parseFloat(a.height)?a.height=d:a.height=parseFloat(a.height);"true"==a.multiline&&""!==a.text&&(d=H(a.text,a.width,a.padding,a["font-style"]),a.text=d.text,d.height>a.height&&(a.height=d.height));G(a.y,a.height)&&(f.addPage(),"undefined"!==typeof b&&(V(b),a.x=parseFloat(c.template.page.cursor.x)),E(a),a.y=parseFloat(c.template.page.cursor.y));"undefined"!==typeof a["background-color"]&&null!==a["background-color"]&&
f.rect(a.x,a.y,a.width,a.height,"F");"undefined"!==typeof a.border&&null!==a.border&&("1"===a.border?f.rect(a.x,a.y,a.width,a.height):(-1<a.border.indexOf("L")&&f.line(a.x,a.y,a.x,a.y+a.height),-1<a.border.indexOf("R")&&f.line(a.x+a.width,a.y,a.x+a.width,a.y+a.height),-1<a.border.indexOf("T")&&f.line(a.x,a.y,a.x+a.width,a.y),-1<a.border.indexOf("B")&&f.line(a.x,a.y+a.height,a.x+a.width,a.y+a.height)));d=a.x+a.padding;if("undefined"===typeof a.align||null===a.align)a.align="left";if("false"==a.multiline){switch(a.align){case "right":d=
a.x+(a.width-parseFloat(f.getStringUnitWidth(a.text)*f.internal.getFontSize()/f.internal.scaleFactor)-a.padding);break;case "center":d=a.x+(a.width-parseFloat(f.getStringUnitWidth(a.text)*f.internal.getFontSize()/f.internal.scaleFactor))/2;break;default:d=a.x+a.padding}f.text(a.text,d,a.y+(.5*a.height+.3*f.internal.getFontSize()/f.internal.scaleFactor))}else for(var e=0;e<a.text.length;e++)f.text(a.text[e],d,a.y+f.internal.getLineHeight()/f.internal.scaleFactor*(e+1));0<a.ln?(a.y+=a.height,1===a.ln&&
(a.x=c.template.margins["left-margin"])):a.x+=a.width;c.template.page.cursor.x=a.x;c.template.page.cursor.y=a.y;return!0}function ba(a,b){var d=h(b.visible,"");if(""!==d&&("undefined"===typeof c.template.elements.data[d]||0===c.template.elements.data[d].length))return"";for(var d=h(b.hgap,0),e=h(b.height,null),g=e,q=0;q<b.columns.length;q++){c.template.page.cursor.x!==c.template.margins["left-margin"]&&(c.template.page.cursor.x+=parseFloat(d));var n=v(b.columns[q]),k=b.columns[q][n];switch(n){case "cell":var l=
{height:e},l=J(k,l);l.text=D(h(k.value,""));l.width=h(k.width,null);l.border=h(k.border,null);l.align=h(k.align,"left");l.ln=b.columns.length-1===q?1:0;l.multiline="false";l.extend=!0;"details"===a&&(l.multiline=h(k.multiline,"false"));F(l);if(l.height>g||null===g)g=l.height;k=h(k.name,"head");"header"===a&&"label"!==k&&(c.template.xml.header+="\n    <"+k.toString()+"><![CDATA["+l.text.toString()+"]]\x3e</"+k.toString()+">");"details"===a&&"label"!==k&&(c.template.xml.details+="\n    <"+k.toString()+
"><![CDATA["+l.text.toString()+"]]\x3e</"+k.toString()+">");break;case "image":l=h(k.src,null);if(null!==l&&("data:image"!==l.toString().substr(0,10)&&(l=D(l)),"data:image"===l.toString().substr(0,10))){var m=parseFloat(h(k.width,0)),p=h(k.height,0);if(0===p||0===m)p=S(l),m=p.width,p=p.height;k=h(k.compression,"medium");G(c.template.page.cursor.y,p)&&f.addPage();f.addImage(l,null,c.template.page.cursor.x,c.template.page.cursor.y,m,p,null,k);c.template.page.cursor.x+=m;if(g<p||null===g)g=p}break;case "barcode":var l=
h(k["code-type"],"code39"),r=h(k.value,""),p=h(k["visible-value"],0),t=h(k.wide,L(l,"wide")),k=m=h(k.wide,L(l,"narrow"));1===p&&(k=m+f.internal.getFontSize()/f.internal.scaleFactor);G(c.template.page.cursor.y,k)&&f.addPage();switch(l){case "code39":var l=r,r=(r=t)||1.5,m=m||5,p=p||!1,t=r/3,A=r,u=t,y=l.toUpperCase();f.setFontSize(10);var r=c.template.page.cursor.x,B={0:"nnnwwnwnn",1:"wnnwnnnnw",2:"nnwwnnnnw",3:"wnwwnnnnn",4:"nnnwwnnnw",5:"wnnwwnnnn",6:"nnwwwnnnn",7:"nnnwnnwnw",8:"wnnwnnwnn",9:"nnwwnnwnn",
A:"wnnnnwnnw",B:"nnwnnwnnw",C:"wnwnnwnnn",D:"nnnnwwnnw",E:"wnnnwwnnn",F:"nnwnwwnnn",G:"nnnnnwwnw",H:"wnnnnwwnn",I:"nnwnnwwnn",J:"nnnnwwwnn",K:"wnnnnnnww",L:"nnwnnnnww",M:"wnwnnnnwn",N:"nnnnwnnww",O:"wnnnwnnwn",P:"nnwnwnnwn",Q:"nnnnnnwww",R:"wnnnnnwwn",S:"nnwnnnwwn",T:"nnnnwnwwn",U:"wwnnnnnnw",V:"nwwnnnnnw",W:"wwwnnnnnn",X:"nwnnwnnnw",Y:"wwnnwnnnn",Z:"nwwnwnnnn","-":"nwnnnnwnw",".":"wwnnnnwnn"," ":"nwwnnnwnn","*":"nwnnwnwnn",$:"nwnwnwnnn","/":"nwnwnnnwn","+":"nwnnnwnwn","%":"nnnwnwnwn"};if(W(B,l)){for(var C=
0;C<y.length;C+=2){for(var w=y[C],x="",z=0;z<B[w].length;z++)x+=B[w][z];for(w=0;w<x.length;w++)z="n"===x[w]?t:A,0===w%2&&f.rect(c.template.page.cursor.x,c.template.page.cursor.y,z,m,"F"),c.template.page.cursor.x+=z}c.template.page.cursor.x+=u;p&&(p=parseFloat(f.getStringUnitWidth(l)*f.internal.getFontSize()/f.internal.scaleFactor),r+=(c.template.page.cursor.x-r-p)/2,f.text(l,r,c.template.page.cursor.y+m+f.internal.getFontSize()/f.internal.scaleFactor))}else l="Invalid barcode: "+l,c.template.page.cursor.x+=
c.template.page.padding,f.text(l,c.template.page.cursor.x,c.template.page.cursor.y+f.internal.getLineHeight()/f.internal.scaleFactor),c.template.page.cursor.x+=parseFloat(f.getStringUnitWidth(l)*f.internal.getFontSize()/f.internal.scaleFactor),c.template.page.cursor.x+=c.template.page.padding;break;case "i2of5":if(l=r,r=(r=t)||1,m=m||10,p=p||!1,t=r/3,A=r,f.setFontSize(10),r=c.template.page.cursor.x,u={0:"nnwwn",1:"wnnnw",2:"nwnnw",3:"wwnnn",4:"nnwnw",5:"wnwnn",6:"nwwnn",7:"nnnww",8:"wnnwn",9:"nwnwn",
A:"nn",Z:"wn"},W(u,l)){y=l;0!==y.length%2&&(y="0"+y);y="AA"+y.toLocaleLowerCase()+"ZA";for(B=0;B<y.length;B+=2){x=y[B];w=y[B+1];C="";for(z=0;z<u[x].length;z++)C+=u[x][z]+u[w][z];for(x=0;x<C.length;x++)w="n"===C[x]?t:A,0===x%2&&f.rect(c.template.page.cursor.x,c.template.page.cursor.y,w,m,"F"),c.template.page.cursor.x+=w}p&&(p=parseFloat(f.getStringUnitWidth(l)*f.internal.getFontSize()/f.internal.scaleFactor),r+=(c.template.page.cursor.x-r-p)/2,f.text(l,r,c.template.page.cursor.y+m+f.internal.getFontSize()/
f.internal.scaleFactor))}else l="Invalid barcode: "+l,c.template.page.cursor.x+=c.template.page.padding,f.text(l,c.template.page.cursor.x,c.template.page.cursor.y+f.internal.getLineHeight()/f.internal.scaleFactor),c.template.page.cursor.x+=parseFloat(f.getStringUnitWidth(l)*f.internal.getFontSize()/f.internal.scaleFactor),c.template.page.cursor.x+=c.template.page.padding}if(g<k||null===g)g=k;break;case "separator":null!==g&&(k=h(k.gap,0),f.line(c.template.page.cursor.x+k,c.template.page.cursor.y,
c.template.page.cursor.x+k,c.template.page.cursor.y+parseFloat(g)),b.columns.length-1<q&&(c.template.page.cursor.x+=k))}"cell"!==n&&b.columns.length-1===q&&(c.template.page.cursor.y+=g,c.template.page.cursor.x=c.template.margins["left-margin"])}return!0}function L(a,b){switch(a){case "code39":return"wide"===b?1.5:5;case "i2of5":return"wide"===b?1:10}return 0}function W(a,b){for(var c=0;c<b.toString().length;c++)if(!a.hasOwnProperty(b[c]))return!1;return!0}function t(a,b){switch(a){case "format":b=
h(b,"a4");switch(b){case "a3":case "a4":case "a5":case "letter":case "legal":break;default:b="a4"}return b;case "orientation":b=h(b,"p");switch(b){case "p":case "portrait":case "l":case "landscape":break;default:b="p"}return b;case "unit":b=h(b,"mm");switch(b){case "pt":case "mm":case "cm":case "in":break;default:b="mm"}return b;case "author":case "creator":case "subject":case "title":return b=h(b,c.template.document[a]);case "font-size":case "digit":b=b.toString().replace(/[^0-9\-]|\-(?=.)/g,"");
b=parseInt(h(b,null));if(!isNaN(b))return parseInt(h(b,null));break;case "left-margin":case "right-margin":case "top-margin":case "bottom-margin":case "height":case "gap":case "hgap":case "wide":case "narrow":b=b.toString().replace(/[^0-9\-\.,]|[\-](?=.)|[\.,](?=[0-9]*[\.,])/g,"");b=parseFloat(h(b,null));if(!isNaN(b))return parseFloat(h(b,null));break;case "width":b=b.toString().replace(/[^0-9\-\.,%]|[\-](?=.)|[\.,%](?=[0-9]*[\.,%])/g,"");if(""===b)b=null;else if(-1<b.indexOf("%")){var d=parseInt(b.replace("%",
""));100<d&&(d=100);b=d.toString()+"%"}else b=parseFloat(b);return b;case "src":case "value":case "name":case "databind":case "label":case "fieldname":case "thousands":case "footer":case "decpoint":case "visible":case "border":case "html":case "code-type":return b;case "merge":case "visible-value":return b=parseInt(h(b,0)),0!==b?1:b;case "multiline":return b=h(b,"false"),"false"!==b?"true":b;case "compression":b=h(b,"medium");switch(b){case "fast":case "medium":case "slow":break;default:b="medium"}return b;
case "align":case "header-align":case "footer-align":switch(b=h(b,"left"),b){case "R":return"right";case "C":return"center";case "left":case "center":case "right":return b;default:return"left"}case "font-family":b=h(b,null);if("times"!==b||"helvetica"!==b||"courier"!==b)b="times";return b;case "font-style":b=h(b,null);if(null!==b){switch(b){case "B":b="bold";break;case "I":b="italic";break;case "BI":case "IB":b="bolditalic";break;case "bold":case "italic":case "bolditalic":case "normal":break;default:b=
"normal"}return b}break;case "color":b=h(b,null);if(null!==b)if("#"!==b.toString().charAt(0)){if(!isNaN(parseInt(b)))return b="#"+parseInt(b).toString(16).toUpperCase()}else return b;break;case "border-color":case "background-color":case "footer-background":case "header-background":if(b=h(b,null),null!==b){if("#"===b.toString().charAt(0))return b=P(b);if(!isNaN(parseInt(b)))return 255<parseInt(b)&&(b=P(parseInt(b).toString(16).toUpperCase())),parseInt(b)}}return null}function A(a,b){for(var c=0;c<
a.attributes.length;c++){var e=t(a.attributes[c].name,a.attributes[c].value);null!==e&&(b[a.attributes[c].name]=e)}}function M(a,b){for(var d=0;d<b.childNodes.length;d++)switch(b.childNodes[d].nodeName){case "row":var e=b.childNodes[d],g={};g[b.childNodes[d].nodeName]={columns:[]};A(e,g[b.childNodes[d].nodeName]);for(var e=e.childNodes,f=0;f<e.length;f++)"#text"!==e[f].nodeName&&(e=e[f]);for(f=0;f<e.childNodes.length;f++)switch(e.childNodes[f].nodeName){case "cell":case "image":case "barcode":case "separator":var h=
{};h[e.childNodes[f].nodeName]={};A(e.childNodes[f],h[e.childNodes[f].nodeName]);g[b.childNodes[d].nodeName].columns.push(h)}c.template.elements[a].push(g);break;case "datagrid":g=b.childNodes[d];e={};e[b.childNodes[d].nodeName]={columns:[]};A(g,e[b.childNodes[d].nodeName]);for(f=0;f<g.childNodes.length;f++)switch(g.childNodes[f].nodeName){case "header":case "footer":h=t("background-color",g.childNodes[f].attributes["background-color"].value);null!==h&&(e[b.childNodes[d].nodeName][g.childNodes[f].nodeName+
"_background"]=h);break;case "columns":for(var h=g.childNodes[f],k=0;k<h.childNodes.length;k++)if("column"===h.childNodes[k].nodeName){var l={};l[h.childNodes[k].nodeName]={};A(h.childNodes[k],l[h.childNodes[k].nodeName]);e[b.childNodes[d].nodeName].columns.push(l)}}c.template.elements[a].push(e);break;case "html":g={};g[b.childNodes[d].nodeName]={};A(b.childNodes[d],g[b.childNodes[d].nodeName]);g[b.childNodes[d].nodeName].html=b.childNodes[d].textContent||"";c.template.elements[a].push(g);break;
case "vgap":case "hline":g={},g[b.childNodes[d].nodeName]={},A(b.childNodes[d],g[b.childNodes[d].nodeName]),c.template.elements[a].push(g)}}function u(a,b){for(var c=0;c<Object.keys(a).length;c++){var e=Object.keys(a)[c],g=t(e,a[e]);null!==g&&(b[e]=g)}}function N(a,b){for(var d=0;d<b.length;d++){var e=v(b[d]);switch(e){case "row":var g=b[d][e],f={};f[e]={columns:[]};u(g,f[e]);for(var h=0;h<g.columns.length;h++){var k=v(g.columns[h]),l={};l[k]={};u(g.columns[h][k],l[k]);f[e].columns.push(l)}c.template.elements[a].push(f);
break;case "datagrid":g=b[d][e];f={};f[e]={columns:[]};u(g,f[e]);for(e=0;e<g.columns.length;e++)h={column:{}},u(g.columns[e].column,h.column),f.datagrid.columns.push(h);c.template.elements[a].push(f);break;case "html":g={};g[e]={};u(b[d][e],g[e]);g[e].html=b[d][e].html;c.template.elements[a].push(g);break;case "vgap":case "hline":g={},g[e]={},u(b[d][e],g[e]),c.template.elements[a].push(g)}}}function O(a,b){for(var c=0;c<b.length;c++){if(a===b[c])return b;var e=v(b[c]);if("row"===e||"datagrid"===e)for(var g=
0;g<b[c][e].columns.length;g++)if(a===b[c][e].columns[g])return b[c][e].columns}return null}function I(a,b,c){for(var e=0;e<a.length;e++)for(var g=v(a[e]),f=c.appendChild(b.createElement(g)),h=0;h<Object.keys(a[e][g]).length;h++){var k=Object.keys(a[e][g])[h],l=a[e][g][k];"object"===typeof l?Array.isArray(l)?(k=f.appendChild(b.createElement(k)),I(l,b,k)):f.setAttribute(k,l):"html"===k?f.appendChild(b.createCDATASection(l)):f.setAttribute(k,l)}}function X(){c.template.document.author=c.template.elements.report.author||
c.template.document.author;c.template.document.creator=c.template.elements.report.creator||c.template.document.creator;c.template.document.subject=c.template.elements.report.subject||c.template.document.subject;c.template.document.title=c.template.elements.report.title||c.template.document.title;"undefined"!==typeof c.template.elements.report["font-family"]&&(c.template.style["font-family"]=c.template.elements.report["font-family"]);"undefined"!==typeof c.template.elements.report["font-style"]&&(c.template.style["font-style"]=
c.template.elements.report["font-style"]);"undefined"!==typeof c.template.elements.report["font-size"]&&(c.template.style["font-size"]=c.template.elements.report["font-size"]);"undefined"!==typeof c.template.elements.report.color&&(c.template.style.color=c.template.elements.report.color);"undefined"!==typeof c.template.elements.report["border-color"]&&(c.template.style["border-color"]=c.template.elements.report["border-color"]);"undefined"!==typeof c.template.elements.report["background-color"]&&
(c.template.style["background-color"]=c.template.elements.report["background-color"]);c.template.margins["left-margin"]=c.template.elements.report["left-margin"]||c.template.margins["left-margin"];c.template.margins["right-margin"]=c.template.elements.report["right-margin"]||c.template.margins["right-margin"];c.template.margins["top-margin"]=c.template.elements.report["top-margin"]||c.template.margins["top-margin"];c.template.margins["bottom-margin"]=c.template.elements.report["bottom-margin"]||c.template.margins["bottom-margin"]}
var c=this;c.orientation=t("orientation",Y);c.unit=t("unit",Z);c.format=t("format",aa);c.template={document:{title:"Nervatura Report",author:"",creator:"",subject:"",keywords:""},margins:{"left-margin":12,"top-margin":12,"right-margin":12,"bottom-margin":12},style:{"font-family":"times","font-style":"normal","font-size":12,color:"#000000","border-color":0,"background-color":255},elements:{report:{},header:[],details:[],footer:[],data:{}},xml:{header:"",details:""},page:{cursor:{x:0,y:0},padding:2,
header_height:0,footer_height:0,current_page:1}};var f=new jsPDF({orientation:c.orientation,unit:c.unit,format:c.format,textColor:c.template.style.color,drawColor:c.template.style["border-color"],fontSize:c.template.style["font-size"]});f.internal.events.subscribe("addPage",function(a){c.template.page.current_page=a.pageNumber;a=c.template.page.footer_height;c.template.page.footer_height=0;c.template.page.cursor.y=f.internal.pageSize.height-c.template.margins["bottom-margin"]-a;U();c.template.page.cursor.y=
c.template.margins["top-margin"];c.template.page.footer_height=a;T();c.template.page.cursor.x=c.template.margins["left-margin"];c.template.page.cursor.y=c.template.margins["top-margin"]+c.template.page.header_height});c.loadJsonDefinition=function(a){if(null===a||""===a||"undefined"===typeof a)return!0;"string"===typeof a&&(a=JSON.parse(a));c.template.elements={report:{},header:[],details:[],footer:[],data:{}};c.template.element_matrix=[];"undefined"!==typeof a.report&&u(a.report,c.template.elements.report);
"undefined"!==typeof a.header&&N("header",a.header);"undefined"!==typeof a.details&&N("details",a.details);"undefined"!==typeof a.footer&&N("footer",a.footer);if("undefined"!==typeof a.data)for(var b=c.template.elements.data,d=0;d<Object.keys(a.data).length;d++){var e=Object.keys(a.data)[d];if("object"===typeof a.data[e])if(Array.isArray(a.data[e])){b[e]=[];for(var g=0;g<a.data[e].length;g++){for(var f={},h=0;h<Object.keys(a.data[e][g]).length;h++)f[Object.keys(a.data[e][g])[h]]=a.data[e][g][Object.keys(a.data[e][g])[h]];
b[e].push(f)}}else for(b[e]={},g=0;g<Object.keys(a.data[e]).length;g++)b[e][Object.keys(a.data[e])[g]]=a.data[e][Object.keys(a.data[e])[g]];else b[e]=a.data[e]}X();return!0};c.loadDefinition=function(a){if(null!==a&&""!==a&&"string"===typeof a){c.template.elements={report:{},header:[],details:[],footer:[],data:{}};c.template.element_matrix=[];var b=(new DOMParser).parseFromString(a,"application/xml");0<b.getElementsByTagName("report").length&&A(b.getElementsByTagName("report")[0],c.template.elements.report);
0<b.getElementsByTagName("header").length&&M("header",b.getElementsByTagName("header")[0]);0<b.getElementsByTagName("details").length&&M("details",b.getElementsByTagName("details")[0]);0<b.getElementsByTagName("footer").length&&M("footer",b.getElementsByTagName("footer")[0]);if(0<b.getElementsByTagName("data").length){a=c.template.elements.data;for(var b=b.getElementsByTagName("data")[0],d=0;d<b.childNodes.length;d++)if("#text"!==b.childNodes[d].nodeName)if(0<b.childNodes[d].childNodes.length)if(1===
b.childNodes[d].childNodes.length&&"#text"===b.childNodes[d].childNodes[0].nodeName)a[b.childNodes[d].nodeName]=b.childNodes[d].childNodes[0].textContent;else if(1===b.childNodes[d].childNodes.length&&"#cdata-section"===b.childNodes[d].childNodes[0].nodeName)a[b.childNodes[d].nodeName]=b.childNodes[d].childNodes[0].data;else{a[b.childNodes[d].nodeName]=[];for(var e=0;e<b.childNodes[d].childNodes.length;e++)if("#text"!==b.childNodes[d].childNodes[e].nodeName){for(var f=b.childNodes[d].childNodes[e],
h={},n=0;n<f.attributes.length;n++)h[f.attributes[n].nodeName]=f.attributes[n].value;a[b.childNodes[d].nodeName].push(h)}}else if(0<b.childNodes[d].attributes.length)for(a[b.childNodes[d].nodeName]={},e=0;e<b.childNodes[d].attributes.length;e++)a[b.childNodes[d].nodeName][b.childNodes[d].attributes[e].name]=b.childNodes[d].attributes[e].value;else c.template.elements.data[b.childNodes[d].nodeName]=b.childNodes[d].textContent}X();return!0}return!1};c.setData=function(a,b){c.template.elements.data[a]=
b;return!0};c.getData=function(a){return c.template.elements.data[a]};c.createReport=function(){if(0<c.template.elements.details.length){c.template.page.cursor={x:c.template.margins["left-margin"],y:c.template.margins["top-margin"]};f.setProperties({author:c.template.document.author,creator:c.template.document.creator,subject:c.template.document.subject,title:c.template.document.title});E({});var a;a=0;for(var b=c.template.elements.footer,d=0;d<b.length;d++){var e=v(b[d]),g=b[d][e];switch(e){case "row":for(var e=
h(g.height,0),q=0;q<Object.keys(g.columns).length;q++){var n=v(g.columns[q]),k=g.columns[q][n];switch(n){case "cell":k=h(k.height,null);k=null===k?parseFloat(f.internal.getLineHeight()/f.internal.scaleFactor)+c.template.page.padding:parseFloat(k);k>e&&(e=k);break;case "barcode":var l=h(k["code-type"],"code39"),n=h(k["visible-value"],0),k=h(k.wide,L(l,"narrow"));1===n&&(k+=f.internal.getFontSize()/f.internal.scaleFactor);k>e&&(e=k);break;case "image":n=h(k.src,null),null!==n&&("data:image"!==n.toString().substr(0,
10)&&(n=D(n)),"data:image"===n.toString().substr(0,10)&&(k=h(k.height,0),0===k&&(k=S(n).height),k>e&&(e=k)))}}a+=e;break;case "vgap":a+=h(g.height,0);break;case "hline":a+=1+h(g.gap,0)}}c.template.page.cursor.y=f.internal.pageSize.height-c.template.margins["bottom-margin"]-a;U();c.template.page.cursor.y=c.template.margins["top-margin"];c.template.page.footer_height=a;c.template.page.cursor.x=c.template.margins["left-margin"];T();c.template.page.header_height=c.template.page.cursor.y-c.template.margins["top-margin"];
a=c.template.elements.details;for(b=0;b<a.length;b++)d=v(a[b]),K("details",d,a[b][d])}return!0};c.save2PdfFile=function(a){f.save(a)};c.save2Pdf=function(){return f.output("arraybuffer")};c.save2DataUrl=function(){return f.output("dataurlnewwindow")};c.save2Xml=function(){return"<data>"+c.template.xml.header+c.template.xml.details+"\n</data>"};c.getXmlTemplate=function(){for(var a=(new DOMParser).parseFromString("<template><report /><header></header><details></details><footer></footer><data></data></template>",
"application/xml"),b=0;b<Object.keys(c.template.elements.report).length;b++){var d=Object.keys(c.template.elements.report)[b];a.getElementsByTagName("report")[0].setAttribute(d,c.template.elements.report[d])}I(c.template.elements.header,a,a.getElementsByTagName("header")[0]);I(c.template.elements.details,a,a.getElementsByTagName("details")[0]);I(c.template.elements.footer,a,a.getElementsByTagName("footer")[0]);return(new XMLSerializer).serializeToString(a)};c.insertElement=function(a,b,d,e){if("undefined"===
typeof a||null===a)a=c.template.elements.details;if("undefined"===typeof b||null===b)b="row";if("undefined"===typeof d||null===d)d=-1;if("undefined"===typeof e||null===e)e={};if("object"===typeof a){if(!Array.isArray(a)){var f=v(a);if("row"===f||"datagrid"===f)a=a[f].columns}}else return null;f={};f[b]={};switch(b){case "row":case "datagrid":f[b].columns=[];break;case "vgap":case "hline":case "html":case "column":case "cell":case "image":case "barcode":case "separator":break;default:return null}if(d>
a.length||0>d)d=a.length;a.splice(d,0,f);for(a=0;a<Object.keys(e).length;a++)d=Object.keys(e)[a],f[b][d]=t(d,e[d]);return f};c.editElement=function(a,b){var c=v(a);if(null!==c){for(var e=0;e<Object.keys(b).length;e++){var f=Object.keys(b)[e];a[c].hasOwnProperty(f)&&null===b[f]?delete a[c][f]:a[c][f]=b[f]}return!0}return!1};c.deleteElement=function(a,b){if("undefined"===typeof b||null===b){var d=O(a,c.template.elements.details);null===d&&(d=O(a,c.template.elements.header));null===d&&(d=O(a,c.template.elements.footer));
b=d}if(null!==b&&!Array.isArray(b))if(d=v(b),"row"===d||"datagrid"===d)b=b[d].columns;else return!1;return null!==b?(d=b.indexOf(a),-1<d&&b.splice(d,1),!0):!1}};